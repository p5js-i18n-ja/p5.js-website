---
title: p5.Shader
module: 3D
submodule: Material
file: src/webgl/p5.Shader.js
description: >
  <p>シェーダープログラムを記述するクラスです。</p>

  <p>各<code>p5.Shader</code>オブジェクトには、グラフィックス処理ユニット（GPU）上で
  実行されるシェーダープログラムが含まれています。シェーダーは多くのピクセルや頂点を
  同時に処理できるため、多くのグラフィックスタスクに対して高速です。シェーダーは
  <a
  href="https://developer.mozilla.org/en-US/docs/Games/Techniques/3D_on_the_web/GLSL_Shaders/"
  target="_blank">GLSL</a>
  という言語で書かれ、スケッチの他のコードと一緒に実行されます。</p>

  <p>シェーダープログラムは、頂点シェーダーとフラグメントシェーダーの2つのファイルで
  構成されています。頂点シェーダーは3Dジオメトリが画面上のどこに描画されるかに影響し、
  フラグメントシェーダーは色に影響します。<code>p5.Shader</code>オブジェクトが
  作成されると、<a href="/reference/p5/shader/">shader()</a>関数で使用できます。
  例えば、<code>shader(myShader)</code>のように使います。</p>

  <p>注意：<a href="/reference/p5/createShader/">createShader()</a>、
  <a href="/reference/p5/createFilterShader/">createFilterShader()</a>、
  <a href="/reference/p5/loadShader/">loadShader()</a>が、このクラスの
  インスタンスを作成する推奨される方法です。</p>
line: 11
isConstructor: true
params:
  - name: renderer
    description: |
      <p>このシェーダーのWebGLコンテキスト。</p>
    type: p5.RendererGL
  - name: vertSrc
    description: |
      <p>頂点シェーダープログラムのソースコード。</p>
    type: String
  - name: fragSrc
    description: |
      <p>フラグメントシェーダープログラムのソースコード。</p>
    type: String
example:
  - |-

    <div>
    <code>
    // 注意：「uniform」はシェーダープログラム内のグローバル変数です。

    // 頂点シェーダープログラムを含む文字列を作成します。
    // 頂点シェーダーは各頂点に対して呼び出されます。
    let vertSrc = `
    precision highp float;
    uniform mat4 uModelViewMatrix;
    uniform mat4 uProjectionMatrix;

    attribute vec3 aPosition;
    attribute vec2 aTexCoord;
    varying vec2 vTexCoord;

    void main() {
      vTexCoord = aTexCoord;
      vec4 positionVec4 = vec4(aPosition, 1.0);
      gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
    }
    `;

    // フラグメントシェーダープログラムを含む文字列を作成します。
    // フラグメントシェーダーは各ピクセルに対して呼び出されます。
    let fragSrc = `
    precision highp float;

    void main() {
      // 各ピクセルのRGBA値を黄色に設定します。
      gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);
    }
    `;

    function setup() {
      createCanvas(100, 100, WEBGL);

      // p5.Shaderオブジェクトを作成します。
      let myShader = createShader(vertSrc, fragSrc);

      // p5.Shaderオブジェクトを適用します。
      shader(myShader);

      // 描画面のスタイルを設定します。
      noStroke();

      // 描画面としてplaneを追加します。
      plane(100, 100);

      describe('黄色の正方形。');
    }
    </code>
    </div>

    <div>
    <code>
    // 注意：「uniform」はシェーダープログラム内のグローバル変数です。

    let mandelbrot;

    // シェーダーを読み込み、p5.Shaderオブジェクトを作成します。
    function preload() {
      mandelbrot = loadShader('/assets/shader.vert', '/assets/shader.frag');
    }

    function setup() {
      createCanvas(100, 100, WEBGL);

      // p5.Shaderオブジェクトを使用します。
      shader(mandelbrot);

      // シェーダーのuniform変数pを配列に設定します。
      mandelbrot.setUniform('p', [-0.74364388703, 0.13182590421]);

      describe('フラクタル画像がズームインとズームアウトを繰り返します。');
    }

    function draw() {
      // シェーダーのuniform変数rを0から2の間で振動する値に設定します。
      mandelbrot.setUniform('r', sin(frameCount * 0.01) + 1);

      // シェーダーの表示面としてquadを追加します。
      quad(-1, -1, 1, -1, 1, 1, -1, 1);
    }
    </code>
    </div>
methods:
  copyToContext:
    description: >
      <p>シェーダーを一つの描画コンテキストから別のコンテキストにコピーします。</p>

      <p>各<code>p5.Shader</code>オブジェクトは、実行前に
      <a href="/reference/p5/shader/">shader()</a>を呼び出してコンパイルする必要が
      あります。コンパイルは通常、メインキャンバスまたは
      <a href="/reference/p5/p5.Graphics">p5.Graphics</a>のインスタンスである
      描画コンテキストで行われます。シェーダーはコンパイルされたコンテキストでのみ
      使用できます。<code>copyToContext()</code>メソッドはシェーダーを再度コンパイルし、
      再利用可能な別の描画コンテキストにコピーします。</p>

      <p>パラメータ<code>context</code>は、シェーダーが使用される描画コンテキストです。
      シェーダーは<a href="/reference/p5/p5.Graphics">p5.Graphics</a>のインスタンスに
      コピーできます。例えば、<code>myShader.copyToContext(pg)</code>のようにします。
      また、シェーダーを<a href="/reference/p5/p5.Graphics">p5.Graphics</a>オブジェクトから
      メインキャンバスにコピーする場合は、<code>window</code>変数を使用します。
      例えば、<code>myShader.copyToContext(window)</code>のようにします。</p>

      <p>注意：<a href="/reference/p5/createShader/">createShader()</a>、
      <a href="/reference/p5/createFilterShader/">createFilterShader()</a>、または
      <a href="/reference/p5/loadShader/">loadShader()</a>で作成された
      <a href="/reference/p5/p5.Shader">p5.Shader</a>オブジェクトは、
      <a href="/reference/p5/createFramebuffer/">createFramebuffer()</a>で作成された
      <a href="/reference/p5/p5.Framebuffer">p5.Framebuffer</a>オブジェクトと
      直接使用できます。両オブジェクトはメインキャンバスと同じコンテキストを持ちます。</p>
    path: p5.Shader/copyToContext
  setUniform:
    description: >
      <p>シェーダーのuniform（グローバル）変数を設定します。</p>

      <p>シェーダープログラムはコンピューターのグラフィックス処理ユニット（GPU）上で
      実行されます。シェーダーはスケッチを実行するメモリとは完全に分離された
      コンピューターのメモリ部分に存在します。uniformはシェーダープログラム内の
      グローバル変数です。uniformは、CPU上で実行されているスケッチからGPU上で
      実行されているシェーダープログラムに値を渡す方法を提供します。</p>

      <p>最初のパラメータ<code>uniformName</code>は、uniformの名前を含む文字列です。
      上記のシェーダーの場合、<code>uniformName</code>は<code>'r'</code>となります。</p>

      <p>2番目のパラメータ<code>data</code>は、uniformを設定するために使用される値です。
      例えば、<code>myShader.setUniform('r', 0.5)</code>を呼び出すと、上記のシェーダーの
      <code>r</code> uniformが<code>0.5</code>に設定されます。dataはuniformの型と
      一致する必要があります。数値、文字列、ブール値、配列、および多くの種類の画像を
      <code>setUniform()</code>を使用してシェーダーに渡すことができます。</p>
    path: p5.Shader/setUniform
chainable: false
---


# p5.Shader

